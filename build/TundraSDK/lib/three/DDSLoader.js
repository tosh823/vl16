/*
 * @author mrdoob / http://mrdoob.com/
 */
THREE.DDSLoader=function(){this._parser=THREE.DDSLoader.parse},THREE.DDSLoader.prototype=Object.create(THREE.CompressedTextureLoader.prototype),THREE.DDSLoader.prototype.constructor=THREE.DDSLoader,THREE.DDSLoader.parse=function(a,b){function c(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function d(a){return String.fromCharCode(255&a,a>>8&255,a>>16&255,a>>24&255)}function e(a,b,c,d){for(var e=c*d*4,f=new Uint8Array(a,b,e),g=new Uint8Array(e),h=0,i=0,j=0;j<d;j++)for(var k=0;k<c;k++){var l=f[i];i++;var m=f[i];i++;var n=f[i];i++;var o=f[i];i++,g[h]=n,h++,//r
g[h]=m,h++,//g
g[h]=l,h++,//b
g[h]=o,h++}return g}var f={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},g=542327876,h=131072,i=512,j=1024,k=2048,l=4096,m=8192,n=16384,o=32768,p=4,q=c("DXT1"),r=c("DXT3"),s=c("DXT5"),t=c("ETC1"),u=31,v=0,w=1,x=2,y=3,z=4,A=7,B=20,C=21,D=22,E=23,F=24,G=25,H=26,I=28,J=new Int32Array(a,0,u);if(J[v]!==g)return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),f;if(!J[B]&p)return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),f;var K,L=J[C],M=!1;switch(L){case q:K=8,f.format=THREE.RGB_S3TC_DXT1_Format;break;case r:K=16,f.format=THREE.RGBA_S3TC_DXT3_Format;break;case s:K=16,f.format=THREE.RGBA_S3TC_DXT5_Format;break;case t:K=8,f.format=THREE.RGB_ETC1_Format;break;default:if(!(32===J[D]&&16711680&J[E]&&65280&J[F]&&255&J[G]&&4278190080&J[H]))return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",d(L)),f;M=!0,K=64,f.format=THREE.RGBAFormat}f.mipmapCount=1,J[x]&h&&b!==!1&&(f.mipmapCount=Math.max(1,J[A]));var N=J[I];if(f.isCubemap=!!(N&i),f.isCubemap&&(!(N&j)||!(N&k)||!(N&l)||!(N&m)||!(N&n)||!(N&o)))return console.error("THREE.DDSLoader.parse: Incomplete cubemap faces"),f;f.width=J[z],f.height=J[y];for(var O=J[w]+4,P=f.isCubemap?6:1,Q=0;Q<P;Q++)for(var R=f.width,S=f.height,T=0;T<f.mipmapCount;T++){if(M)var U=e(a,O,R,S),V=U.length;else var V=Math.max(4,R)/4*Math.max(4,S)/4*K,U=new Uint8Array(a,O,V);var W={data:U,width:R,height:S};f.mipmaps.push(W),O+=V,R=Math.max(R>>1,1),S=Math.max(S>>1,1)}return f};